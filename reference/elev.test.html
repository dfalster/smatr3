<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>One-sample test of a (standardised) major axis elevation — elev.test • smatr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="One-sample test of a (standardised) major axis elevation — elev.test" />
<meta property="og:description" content="Test if the elevation of a major axis or standardised
 major axis equals a specific value. This can now be done via sma(y~x,elev.test=0), 
 see help on the sma function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/smatr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Examples.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dfalster/smatr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>One-sample test of a (standardised) major axis elevation</h1>
    
    <div class="hidden name"><code>elev.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test if the elevation of a major axis or standardised
 major axis equals a specific value. This can now be done via <code><a href='sma.html'>sma(y~x,elev.test=0)</a></code>, 
 see help on the <code><a href='sma.html'>sma</a></code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>elev.test</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>x</span>, test.value <span class='op'>=</span> <span class='fl'>0</span>, data <span class='op'>=</span> <span class='cn'>NULL</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
        method <span class='op'>=</span> <span class='st'>'SMA'</span>, robust <span class='op'>=</span> <span class='cn'>FALSE</span>, V <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span> <span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>The Y-variable</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>The X-variable</p></td>
    </tr>
    <tr>
      <th>test.value</th>
      <td><p>The hypothesised value of the elevation (default value is 0)</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Deprecated. Use with() instead (see Examples).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The desired confidence level for the 100(1-alpha)% confidence interval for the common slope. (Default value is 0.05, which returns a 95% confidence interval.)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The line fitting method:</p><dl>
      <dt>'OLS' or 0</dt><dd><p>linear regression</p></dd>
      <dt>'SMA' or 1</dt><dd><p>standardised major axis (this is the default)</p></dd>
      <dt>'MA' or 2</dt><dd><p>major axis</p></dd>
    
</dl><p></p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>The estimated variance matrix of measurement error. Default is that there is no measurement error.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>t</dt><dd><p>The test statistic (a t-statistic).</p></dd>
    <dt>p</dt><dd><p>The P-value, taken from the \(t_{n-2}\)-distribution. This is an exact test if residuals are normally distributed.</p></dd>
    <dt>test.value</dt><dd><p>The hypothesised value of the elevation.</p></dd>
    <dt>a</dt><dd><p>The estimated elevation.</p></dd>
    <dt>ci</dt><dd><p>A 100(1-alpha)% CI for the slope.</p></dd>
  
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Tests if the line relating y to x has an elevation equal to test.value (which has a default value of 0). The line can be a linear regression line, major axis or standardised major axis (as selected using the input argument choice). The test is carried out usinga t-statistic, comparing the difference between estimated and hypothesised elevation to the standard error of elevation. As described in Warton et al (2006).</p>
<p>A confidence interval for the elevation is also returned, again using the t-distribution.</p>
<p>If measurement error is present, it can be corrected for through use of the input argument V, which makes adjustments to the estimated sample variances and covariances then proceeds with the same method of inference. Note, however, that this method is only approximate (see Warton et al 2006 for more details).</p>
<p>The test assumes the following:</p><ol>
<li><p>y and x are linearly related</p></li>
<li><p>residuals independently follow a normal distribution with equal variance at all points along the line</p></li>
</ol>      

<p>The assumptions can be visually checked by plotting residual scores against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using the <code><a href='plot.sma.html'>plot.sma</a></code> function.</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259--291.</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Warton, D.I.<a href='mailto:David.Warton@unsw.edu.au'>David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sma.html'>sma</a></code>, <code><a href='line.cis.html'>line.cis</a></code>, <code><a href='slope.test.html'>slope.test</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#load the leaflife dataset:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>leaflife</span><span class='op'>)</span>

<span class='co'>#consider only the low rainfall sites:</span>
<span class='va'>leaf.low.rain</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>leaflife</span>, <span class='va'>rain</span><span class='op'>==</span><span class='st'>"low"</span><span class='op'>)</span>

<span class='co'>#construct a plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>leaf.low.rain</span><span class='op'>$</span><span class='va'>lma</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>leaf.low.rain</span><span class='op'>$</span><span class='va'>longev</span><span class='op'>)</span>,
   xlab<span class='op'>=</span><span class='st'>"leaf mass per area [log scale]"</span>, ylab<span class='op'>=</span><span class='st'>"leaf longevity [log scale]"</span><span class='op'>)</span>
</div><div class='img'><img src='elev.test-1.png' alt='' width='700' height='433' /></div><div class='input'>    
<span class='co'>#test if the SMA elevation is 0 for leaf longevity vs LMA</span>
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>leaf.low.rain</span>, <span class='fu'>elev.test</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lma</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>longev</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $t
#&gt; [1] 110.5039
#&gt; 
#&gt; $a
#&gt; [1] 2.132489
#&gt; 
#&gt; $p
#&gt; [1] 8.08354e-42
#&gt; 
#&gt; $a.ci
#&gt; [1] 2.093130 2.171847
#&gt; 
#&gt; $test.value
#&gt; [1] 0
#&gt; </div><div class='input'>
<span class='co'>#test if the MA elevation is 2</span>
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>leaf.low.rain</span>,<span class='fu'>elev.test</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lma</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>longev</span><span class='op'>)</span>,
   test.value <span class='op'>=</span> <span class='fl'>2</span>, method <span class='op'>=</span> <span class='st'>"MA"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $t
#&gt; [1] 6.99029
#&gt; 
#&gt; $a
#&gt; [1] 2.137169
#&gt; 
#&gt; $p
#&gt; [1] 7.604775e-08
#&gt; 
#&gt; $a.ci
#&gt; [1] 2.097148 2.177190
#&gt; 
#&gt; $test.value
#&gt; [1] 2
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Warton, Remko Duursma, Daniel Falster, Sara Taskinen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


