<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>(Standardized) major axis estimation and testing for one or several samples — sma • smatr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="(Standardized) major axis estimation and testing for one or several samples — sma" />
<meta property="og:description" content="The sma and ma functions fit SMA and MA respectively, and construct confidence 
intervals or test hypotheses about slope or elevation in one or several samples, depending on how the arguments 
are specified. Options exist to force lines through the origin, (approximately) correct for measurement error if the 
measurement error variance is known, and use robust estimation to ensure that inferences are valid in
the presence of outliers (currently implemented for single samples only)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/smatr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/traitecoevo/smatr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>(Standardized) major axis estimation and testing for one or several samples</h1>
    
    <div class="hidden name"><code>sma.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>sma</code> and <code>ma</code> functions fit SMA and MA respectively, and construct confidence 
intervals or test hypotheses about slope or elevation in one or several samples, depending on how the arguments 
are specified. Options exist to force lines through the origin, (approximately) correct for measurement error if the 
measurement error variance is known, and use robust estimation to ensure that inferences are valid in
the presence of outliers (currently implemented for single samples only).</p>
    </div>

    <pre class="usage"><span class='fu'>sma</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, <span class='va'>subset</span>, <span class='va'>na.action</span>, log<span class='op'>=</span><span class='st'>""</span>,
   method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SMA"</span>,<span class='st'>"MA"</span>,<span class='st'>"OLS"</span><span class='op'>)</span>, type<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"elevation"</span>,<span class='st'>"shift"</span><span class='op'>)</span>, 
   alpha<span class='op'>=</span><span class='fl'>0.05</span>, slope.test<span class='op'>=</span><span class='cn'>NA</span>, elev.test<span class='op'>=</span><span class='cn'>NA</span>, 
   multcomp<span class='op'>=</span><span class='cn'>FALSE</span>, multcompmethod<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"default"</span>,<span class='st'>"adjusted"</span><span class='op'>)</span>,
   robust<span class='op'>=</span><span class='cn'>FALSE</span>,V<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span>,n_min<span class='op'>=</span><span class='fl'>3</span>,quiet<span class='op'>=</span><span class='cn'>FALSE</span>,
   <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>Formula of the form y ~ x etc. This determines whether a single (S)MA is fitted, or whether several lines are fitted and compared. See Details.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A dataframe with the x and y variables.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>A subset of the dataframe for fitting; optional.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>What to do with missing values (na.omit, na.fail, etc).</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>One of 'x', 'y', or 'xy' to log10-transform variables.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>If SMA, standardized major axis, if MA, major axis, and if OLS, ordinary least squares.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>If several lines with common slope are to be compared, do you want to test for a change in 'elevation' or for a 'shift' along a common (S)MA. See Details.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The error rate for confidence intervals. Typically 0.05.</p></td>
    </tr>
    <tr>
      <th>slope.test</th>
      <td><p>The hypothesised value to be used, if testing for evidence that (S)MA slope(s) are significantly different from a hypothesised value.</p></td>
    </tr>
    <tr>
      <th>elev.test</th>
      <td><p>The hypothesised value to be used, if testing for evidence that (S)MA elevation(s) are significantly different from a hypothesised value.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>If TRUE, uses a new method of robust line fitting. (Currently available for single-sample testing only.)</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>The estimated variance matrix of measurement error. Average measurement error for Y is in the first row and column, and average measurement error for X is in the second row and column. The default is that there is no measurement error.</p></td>
    </tr>
    <tr>
      <th>n_min</th>
      <td><p>The minimum sample size for a group.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>If TRUE, suppresses all messages.</p></td>
    </tr>
    <tr>
      <th>multcomp</th>
      <td><p>Logical. If TRUE, performs pair-wise comparisons between levels of the grouping variable.</p></td>
    </tr>
    <tr>
      <th>multcompmethod</th>
      <td><p>Whether to adjust the P values for multiple comparisons ('adjusted') or not ('default').</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to internal functions (none at the moment?)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is the key function in the <code><a href='smatr-package.html'>smatr-package</a></code>; all the key estimation and testing 
functionality in the package can all be accessed using this function, via different usages of 
the <code>formula</code> and other arguments, as described below.</p>
<p><b>One-sample testing</b>
The below options allow estimation of a (S)MA, confidence intervals for parameters, and hypothesis testing of parameters, from a single sample of two variables <code>y</code> and <code>x</code>. Use the <code>sma</code> function to fit a standardised major axis (SMA), or use <code>ma</code> in combination with the below options in order to fit major axis (MA) instead.</p><dl>
   <dt><code>sma(y~x)</code></dt><dd><p>Fits a SMA and constructs confidence intervals for the true slope and elevation. Replaces the <code><a href='line.cis.html'>line.cis</a></code> function from previous versions of smatr.</p></dd>
   <dt><code>ma(y~x)</code></dt><dd><p>Fits a MA and constructs confidence intervals for the true slope and elevation. All the below functions also work for MA, if the <code>ma</code> function is called instead of the <code>sma</code> function.</p></dd>
   <dt><code>sma(y~x, slope.test=B)</code></dt><dd><p>Tests if the slope of a SMA equals <code>B</code>.</p></dd>
   <dt><code>sma(y~x, elev.test=A)</code></dt><dd><p>Tests if the elevation of a SMA equals <code>A</code>.</p></dd>
   <dt><code>sma(y~x, robust=T)</code></dt><dd><p>Fits a SMA using Huber's M estimation and constructs confidence intervals for the true slope and elevation. This offers robustness to outliers in estimation and inference, and can be used in combination with the <code>slope.test</code> and <code>elev.test</code> arguments.</p></dd>
   <dt><code>sma(y~x-1)</code></dt><dd><p>Fits a SMA where the line is forced through the origin, and constructs confidence intervals for the true slope. This type of formula can be used in combination with the <code>slope.test</code> argument.</p></dd>

</dl>

<p><b>For several samples:</b>
The below options allow estimation of several (S)MA lines, confidence intervals for parameters, and hypothesis testing of parameters, from two variables <code>y</code> and <code>x</code> for observations that have been classified into several different samples using the factor <code>groups</code>. Use the <code>sma</code> function to fit a standardised major axis (SMA), or use the <code>ma</code> in combination with the below options in order to fir major axis (MA) instead.</p><dl>
      <dt><code>sma(y~x*groups)</code></dt><dd><p>Test if several SMA lines share a common slope, and construct a confidence interval for the true common slope.</p></dd>
      <dt><code>sma(y~x+groups, type="elevation")</code></dt><dd><p>Test if several common slope SMA lines also share a common elevation, and construct a confidence interval for the true common elevation.</p></dd>
      <dt><code>sma(y~x+groups, type="shift")</code></dt><dd><p>Test if several groups of observations have no shift in location along common slope SMA lines.</p></dd>
      <dt><code>sma(y~x*groups, slope.test=B)</code></dt><dd><p>Test if several SMA lines share a common slope whose true value is exactly equal to <code>B</code>.</p></dd>
      <dt><code>sma(y~x+groups, elev.test=A)</code></dt><dd><p>Test if several common-slope SMA lines share a common elevation whose true value is exactly equal to <code>A</code>.</p></dd>
      <dt><code>sma(y~x*groups-1)</code></dt><dd><p>Test if several SMA lines forced through the origin share a common slope. This can also be used in combination with the <code>slope.test</code> argument or when testing for no shift along common (S)MA lines.</p></dd>
    
</dl>

<p>In all cases, estimates and confidence intervals for key parameters are returned, and if a hypothesis test is done, results will be returned and stored in the <code>slope.test</code> or <code>elev.test</code> output arguments.</p>
<p>The <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></code> function can be applied to objects produced using the <code>sma</code> and <code>ma</code> functions, which is highly recommended to visualise results and check assumptions.</p>
<p><b>Multiple comparisons</b>
If multcomp=TRUE, pair-wise comparisons are made between levels of the grouping variable for differences in slope, elevation or shift, depending on the formula used.
The P values can be adjusted for multiple comparisons (using the Sidak correction). See also <code><a href='multcompmatrix.html'>multcompmatrix</a></code> for visualization of the results.
<b>Warning:</b> When using the multiple comparisons (multcomp=TRUE), you must specify a <code>data</code> statement. If your variables are not in a dataframe, simply combine them in a dataframe before calling <code>sma</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>sma</code> or <code>ma</code>, which contains the following output arguments:</p><dl>
<dt>coef</dt><dd><p>The coefficients of the fitted (standardised) major axes. If several samples are being compared, this will return parameters from the alternative model, e.g. assuming separate slopes if testing for common slope, or assuming common slope but separate elevations if testing for common elevation.</p></dd>
<dt>nullcoef</dt><dd><p>The coefficients under the null hypothesis</p></dd>
<dt>alpha</dt><dd><p>As above.</p></dd>
<dt>method</dt><dd><p>The method used in fitting lines: 'MA' or 'SMA'</p></dd>
<dt>intercept</dt><dd><p>Whether or not (S)MA lines were forced through the origin (True or False).</p></dd>
<dt>call</dt><dd><p>The call to the <code>ma</code> or <code>sma</code> function.</p></dd>
<dt>data</dt><dd><p>As above.</p></dd>
<dt>log</dt><dd><p>As above.</p></dd>
<dt>variables</dt><dd><p>A list of the variables used in fitting (S)MA lines.</p></dd>
<dt>origvariables</dt><dd><p>A list of the variables prior to transformation (if any) for use in fitting (S)MA lines.</p></dd>
<dt>groups</dt><dd><p>Levels of the grouping variable, if present in the fit.</p></dd>
<dt>gt</dt><dd><p>Type of grouptest ("slopecom","elevcom",or "shiftcom"), if it was carried out, or "none" if none.</p></dd>
<dt>gtr</dt><dd><p>The result of that grouptest.</p></dd>
<dt>slopetest</dt><dd><p>Output from the hypothesis test of slope(s), if any. Returned as a list of objects, including the P-value (<code>p</code>), the test statistic (<code>r</code> or <code>LR</code>), the (common) slope (<code>b</code>) and its confidence interval (<code>ci</code>).</p></dd>
<dt>elevtest</dt><dd><p>Output from the hypothesis test of elevation(s), if any. Returned as a list of objects, including the P-value (<code>p</code>), the test statistic (<code>t</code> or <code>stat</code>), the (common) elevation (<code>a</code>) and its confidence interval (<code>ci</code>).</p></dd>
<dt>slopetestdone</dt><dd><p>Whether a slopetest was actually carried out.</p></dd>
<dt>elevtestdone</dt><dd><p>Whether an elevation test was actually carried out.</p></dd>
<dt>n</dt><dd><p>Sample size(s).</p></dd>
<dt>r2</dt><dd><p>Squared correlation coefficient.</p></dd>
<dt>pval</dt><dd><p>P-value of the test of correlation coefficient against zero.</p></dd>
<dt>from,to</dt><dd><p>X values corresponding the maximum and minimum fitted values in each group. Used by plot.sma to determine endpoints for fitted lines).</p></dd>
<dt>groupsummary</dt><dd><p>Neatly organized dataframe with coefficients by group.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Warton, D.I., R.A. Duursma, D.S. Falster and S. Taskinen (2012). smatr 3 - an R package for estimation and inference about allometric lines. <em>Methods in Ecology and Evolution</em>. <b>3</b>, 257-259.</p>
<p>Warton D. I. and Weber N. C. (2002) Common slope tests for bivariate structural relationships.  <em>Biometrical Journal</em> <b>44</b>, 161--174.</p>
<p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259--291.</p>
<p>Taskinen S. and Warton D. I. (in press) Robust estimation and inference for bivariate line-fitting in allometry.  <em>Biometrical Journal</em>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Warton, D. I. <a href='mailto:David.Warton@unsw.edu.au'>David.Warton@unsw.edu.au</a>, R.A. Duursma, D. Falster, S. Taskinen</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.sma.html'>plot.sma</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Load leaf lifetime dataset:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>leaflife</span><span class='op'>)</span>

<span class='co'>### One sample analyses ###</span>
<span class='co'># Extract only low-nutrient, low-rainfall data:</span>
<span class='va'>leaf.low</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>leaflife</span>, <span class='va'>soilp</span> <span class='op'>==</span> <span class='st'>'low'</span> <span class='op'>&amp;</span> <span class='va'>rain</span> <span class='op'>==</span> <span class='st'>'low'</span><span class='op'>)</span>

<span class='co'># Fit a MA for log(leaf longevity) vs log(leaf mass per area):</span>
<span class='fu'>ma</span><span class='op'>(</span><span class='va'>longev</span> <span class='op'>~</span> <span class='va'>lma</span>, log<span class='op'>=</span><span class='st'>'xy'</span>, data<span class='op'>=</span><span class='va'>leaflife</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: sma(formula = ..1, data = ..3, log = "xy", method = "MA") 
#&gt; 
#&gt; Fit using Major Axis 
#&gt; 
#&gt; These variables were log-transformed before fitting: xy 
#&gt; 
#&gt; Confidence intervals (CI) are at 95%
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; Coefficients:
#&gt;             elevation    slope
#&gt; estimate    -3.085214 1.492616
#&gt; lower limit -3.968020 1.146777
#&gt; upper limit -2.202407 2.001084
#&gt; 
#&gt; H0 : variables uncorrelated
#&gt; R-squared : 0.4544809 
#&gt; P-value : 4.0171e-10 
#&gt; </div><div class='input'>
<span class='co'># Test if the MA slope is not significantly different from 1:</span>
<span class='va'>ma.test</span> <span class='op'>&lt;-</span> <span class='fu'>ma</span><span class='op'>(</span><span class='va'>longev</span> <span class='op'>~</span> <span class='va'>lma</span>, log<span class='op'>=</span><span class='st'>'xy'</span>, slope.test<span class='op'>=</span><span class='fl'>1</span>, data<span class='op'>=</span><span class='va'>leaflife</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ma.test</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: sma(formula = ..1, data = ..4, log = "xy", method = "MA", slope.test = 1) 
#&gt; 
#&gt; Fit using Major Axis 
#&gt; 
#&gt; These variables were log-transformed before fitting: xy 
#&gt; 
#&gt; Confidence intervals (CI) are at 95%
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; Coefficients:
#&gt;             elevation    slope
#&gt; estimate    -3.085214 1.492616
#&gt; lower limit -3.968020 1.146777
#&gt; upper limit -2.202407 2.001084
#&gt; 
#&gt; H0 : variables uncorrelated
#&gt; R-squared : 0.4544809 
#&gt; P-value : 4.0171e-10 
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; H0 : slope not different from 1 
#&gt; Test statistic : r= 0.3515 with 65 degrees of freedom under H0
#&gt; P-value : 0.0035393 </div><div class='input'>
<span class='co'># Construct a residual plot to check assumptions:</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ma.test</span>,type<span class='op'>=</span><span class='st'>"residual"</span><span class='op'>)</span>
</div><div class='img'><img src='sma-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Several sample analyses ###</span>

<span class='co'># Now consider low-nutrient sites (high and low rainfall):</span>
<span class='va'>leaf.low.soilp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>leaflife</span>, <span class='va'>soilp</span> <span class='op'>==</span> <span class='st'>'low'</span><span class='op'>)</span>

<span class='co'># Fit SMA's separately at each of high and low rainfall sites,</span>
<span class='co'># and test for common slope:</span>
<span class='va'>com.test</span> <span class='op'>&lt;-</span> <span class='fu'>sma</span><span class='op'>(</span><span class='va'>longev</span><span class='op'>~</span><span class='va'>lma</span><span class='op'>*</span><span class='va'>rain</span>, log<span class='op'>=</span><span class='st'>"xy"</span>, data<span class='op'>=</span><span class='va'>leaf.low.soilp</span><span class='op'>)</span>
<span class='va'>com.test</span>
</div><div class='output co'>#&gt; Call: sma(formula = longev ~ lma * rain, data = leaf.low.soilp, log = "xy") 
#&gt; 
#&gt; Fit using Standardized Major Axis 
#&gt; 
#&gt; These variables were log-transformed before fitting: xy 
#&gt; 
#&gt; Confidence intervals (CI) are at 95%
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; Results of comparing lines among groups.
#&gt; 
#&gt; H0 : slopes are equal.
#&gt; Likelihood ratio statistic : 2.367 with 1 degrees of freedom
#&gt; P-value : 0.12395 
#&gt; ------------------------------------------------------------
#&gt; 
#&gt; Use the summary() function to print coefficients by group.</div><div class='input'>
<span class='co'># Plot longevity vs LMA separately for each group:</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>com.test</span><span class='op'>)</span>
</div><div class='img'><img src='sma-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Fit SMA's separately at each of high and low rainfall sites,</span>
<span class='co'># and test if there is a common slope equal to 1:</span>
<span class='fu'>sma</span><span class='op'>(</span><span class='va'>longev</span><span class='op'>~</span><span class='va'>lma</span><span class='op'>*</span><span class='va'>rain</span>, log<span class='op'>=</span><span class='st'>"xy"</span>, slope.test<span class='op'>=</span><span class='fl'>1</span>, data<span class='op'>=</span><span class='va'>leaf.low.soilp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: sma(formula = longev ~ lma * rain, data = leaf.low.soilp, log = "xy", 
#&gt;     slope.test = 1) 
#&gt; 
#&gt; Fit using Standardized Major Axis 
#&gt; 
#&gt; These variables were log-transformed before fitting: xy 
#&gt; 
#&gt; Confidence intervals (CI) are at 95%
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; Results of comparing lines among groups.
#&gt; 
#&gt; H0 : slopes are equal.
#&gt; Likelihood ratio statistic : 2.367 with 1 degrees of freedom
#&gt; P-value : 0.12395 
#&gt; ------------------------------------------------------------
#&gt; 
#&gt; H0 : common slope not different from 1 
#&gt; Likelihood ratio statistic = 8.677 with 2 degrees of freedom under H0
#&gt; P-value : 0.013057 
#&gt; 
#&gt; Use the summary() function to print coefficients by group.</div><div class='input'>
<span class='co'># Fit SMA's with common slope across each of high and low rainfall sites, </span>
<span class='co'># and test for common elevation:</span>
<span class='fu'>sma</span><span class='op'>(</span><span class='va'>longev</span><span class='op'>~</span><span class='va'>lma</span><span class='op'>+</span><span class='va'>rain</span>, log<span class='op'>=</span><span class='st'>"xy"</span>, data<span class='op'>=</span><span class='va'>leaf.low.soilp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: sma(formula = longev ~ lma + rain, data = leaf.low.soilp, log = "xy") 
#&gt; 
#&gt; Fit using Standardized Major Axis 
#&gt; 
#&gt; These variables were log-transformed before fitting: xy 
#&gt; 
#&gt; Confidence intervals (CI) are at 95%
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; Results of comparing lines among groups.
#&gt; 
#&gt; H0 : slopes are equal.
#&gt; Likelihood ratio statistic : 2.367 with 1 degrees of freedom
#&gt; P-value : 0.12395 
#&gt; ------------------------------------------------------------
#&gt; 
#&gt; H0 : no difference in elevation.
#&gt; Wald statistic: 6.566 with 1 degrees of freedom
#&gt; P-value : 0.010393 
#&gt; ------------------------------------------------------------
#&gt; 
#&gt; Use the summary() function to print coefficients by group.</div><div class='input'>
<span class='co'># Fit SMA's with common slope across each of high and low rainfall sites, </span>
<span class='co'># and test for no shift along common SMA:</span>
<span class='fu'>sma</span><span class='op'>(</span><span class='va'>longev</span><span class='op'>~</span><span class='va'>lma</span><span class='op'>+</span><span class='va'>rain</span>, log<span class='op'>=</span><span class='st'>"xy"</span>, type<span class='op'>=</span><span class='st'>"shift"</span>, data<span class='op'>=</span><span class='va'>leaf.low.soilp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: sma(formula = longev ~ lma + rain, data = leaf.low.soilp, log = "xy", 
#&gt;     type = "shift") 
#&gt; 
#&gt; Fit using Standardized Major Axis 
#&gt; 
#&gt; These variables were log-transformed before fitting: xy 
#&gt; 
#&gt; Confidence intervals (CI) are at 95%
#&gt; 
#&gt; ------------------------------------------------------------
#&gt; Results of comparing lines among groups.
#&gt; 
#&gt; H0 : slopes are equal.
#&gt; Likelihood ratio statistic : 2.367 with 1 degrees of freedom
#&gt; P-value : 0.12395 
#&gt; ------------------------------------------------------------
#&gt; 
#&gt; H0 : no shift along common axis.
#&gt; Wald statistic: 0.2091 with 1 degrees of freedom
#&gt; P-value : 0.64745 
#&gt; ------------------------------------------------------------
#&gt; 
#&gt; Use the summary() function to print coefficients by group.</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Warton, Remko Duursma, Daniel Falster, Sara Taskinen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


